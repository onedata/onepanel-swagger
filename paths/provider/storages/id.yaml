get:
  operationId: get_storage_details
  summary: Get storage details
  description: |
    Returns the details of the selected storage.

    ***Example cURL requests***

    **Get Storage Details**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" -X GET https:/$HOST/api/v3/onepanel/provider/storages/$STORAGE_ID

    {
        "type": "s3",
        "storagePathType": "flat",
        "skipStorageDetection": true,
        "signatureVersion": 4,
        "scheme": "http",
        "readonly": false,
        "qosParameters":{
            "storageId": "05b6c0a9b72e475c9d5061b0b7e16947chbcdc",
            "providerId": "03c7e42a793912307b01b1bbb72a3a6bch4c1c"
        },
        "name": "My S3 Storage",
        "maximumCanonicalObjectSize": 67108864,
        "lumaFeed": "auto",
        "importedStorage": false,
        "id": "05b6c0a9b72e475c9d5061b0b7e16947chbcdc",
        "hostname": "iam.exampele.com:80/",
        "fileMode": "0664",
        "dirMode": "0775",
        "bucketName": "bucket1.iam.examplee.com",
        "blockSize": 10485760,
        "accessKey": ""
    }
    ```
  x-onedata-gri:
    type: onp_storage
    id: ?BINDING(id)
    aspect: instance
  tags:
    - Storages
  produces:
    - application/json
  responses:
    '200':
      description: The details of a selected storage.
      schema:
        $ref: '#/definitions/StorageGetDetails'
    '401':
      description: Unauthorized request.
    '403':
      description: Forbidden request.
    '404':
      description: Storage does not exist.
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
    '503':
      description: Services needed to fulfill this request are not running.
  parameters:
    - name: id
      in: path
      type: string
      description: >
        The Id of a storage resource, which details should be returned.
      required: true
  x-code-samples:
    - lang: Shell
      source: >
        onepanel-rest-cli -u onepanel:$PASSPHRASE getStorageDetails
        id=$STORAGE_ID --host https://$HOST:9443

patch:
  operationId: modify_storage
  summary: Modify storage config
  description: |
    Modifies storage configuration.

    ***Example cURL requests***

    **Modify storage name. Notice, that current storage name is the map key.**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" -X PATCH https://$HOST/api/v3/onepanel/provider/storages/$STORAGE_ID \
    -H "Content-Type: application/json" -d '{
        "My S3 Storage": {
            "type":"s3",
            "name": "My S3 Storage Updated"
        }
    }'

    {
        "type": "s3",
        "storagePathType": "flat",
        "skipStorageDetection": "true",
        "signatureVersion": "4",
        "scheme": "http",
        "readonly": false,
        "qosParameters": {
            "storageId": "2456aa013af797dbef27743790a5f12cche680",
            "providerId": "03c7e42a793912307b01b1bbb72a3a6bch4c1c"
        },
        "name": "My S3 Storage Updated",
        "maximumCanonicalObjectSize": "67108864",
        "lumaFeed": "auto",
        "importedStorage": false,
        "id": "2456aa013af797dbef27743790a5f12cche680",
        "hostname": "iam.exampele.com:80/",
        "fileMode": "0664",
        "dirMode": "0775",
        "bucketName": "bucket1.iam.examplee.com",
        "blockSize": "10485760",
        "accessKey": ""
    }
    ```
  x-onedata-gri:
    type: onp_storage
    id: ?BINDING(id)
    aspect: instance
  tags:
    - Storages
  consumes:
    - application/json
  responses:
    '200':
      description: |
        The storage resources have been successfully modified.
        Response contains current storage params and report of file creation test.
      schema:
        $ref: '#/definitions/StorageModifyDetails'
    '401':
      description: Unauthorized request.
    '403':
      description: Forbidden request.
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
    '503':
      description: Services needed to fulfill this request are not running.
  parameters:
    - name: id
      in: path
      type: string
      description: >
        The Id of the storage resource which details should be modified.
      required: true
    - name: storageModifyRequest
      in: body
      description: >
        An object with one key - the current name of the storage that is being
        modified - and its value set to an object with updated parameters.
      schema:
        $ref: '#/definitions/StorageModifyRequest'
      required: true
  x-code-samples:
    - lang: Shell
      source: >
        onepanel-rest-cli id=$STORAGE_ID timeout==10000
        -u onepanel:$PASSPHRASE --host https://$HOST:9443 modifyStorage

delete:
  operationId: remove_storage
  summary: Remove storage
  description: |
    Removes storage from the cluster. Only storage not supporting
    any spaces can be removed.

    ***Example cURL requests***

    **Remove storage**
    ```bash
    curl -H "X-Auth-Token: $TOKEN" -X DELETE https://$HOST/api/v3/onepanel/provider/storages/$STORAGE_ID
    ```
  x-onedata-gri:
    type: onp_storage
    id: ?BINDING(id)
    aspect: instance
  tags:
    - Storages
  consumes:
    - application/json
  responses:
    '204':
      description: Storage has been succesfully removed.
    '401':
      description: Unauthorized request.
    '403':
      description: Forbidden request.
    '404':
      description: Storage does not exist.
    '409':
      description: Storage supports a space and cannot be removed.
    '500':
      description: Internal server error.
      schema:
        $ref: '#/definitions/Error'
  parameters:
    - name: id
      in: path
      type: string
      description: The Id of the storage to remove.
      required: true
  x-code-samples:
    - lang: Shell
      source: >
        onepanel-rest-cli -u onepanel:$PASSPHRASE id=$STORAGE_ID
        removeStorage --host https://$HOST:9443
